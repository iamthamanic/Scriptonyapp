                                            <DraggableScene
                                              scene={scene}
                                              index={sceneIndex}
                                              onStatsClick={() => {
                                                setStatsNode({ type: 'scene', data: scene });
                                                setStatsDialogOpen(true);
                                              }}
                                            >
                                              <Collapsible
                                                open={expandedScenes.has(scene.id)}
                                                onOpenChange={(open) => {
                                                  const next = new Set(expandedScenes);
                                                  if (open) {
                                                    next.add(scene.id);
                                                  } else {
                                                    next.delete(scene.id);
                                                  }
                                                  setExpandedScenes(next);
                                                }}
                                              >
                                                <div
                                                  data-scene-card
                                                  data-scene-id={scene.id}
                                                  className="border-2 rounded-md bg-amber-50 border-amber-200 dark:bg-amber-950/40 dark:border-amber-700 overflow-hidden"
                                                >
                                                  {/* Scene Header */}
                                                  <div className="flex items-center gap-2 p-2 bg-amber-100 dark:bg-amber-900/40">
                                                    <GripVertical className="size-3 text-muted-foreground cursor-grab" />

                                                    <CollapsibleTrigger asChild>
                                                      <button className="p-1 hover:bg-amber-200 dark:hover:bg-amber-800 rounded transition-colors">
                                                        {expandedScenes.has(scene.id) ? (
                                                          <ChevronDown className="size-3" />
                                                        ) : (
                                                          <ChevronRight className="size-3" />
                                                        )}
                                                      </button>
                                                    </CollapsibleTrigger>

                                                    <span className="flex-1 text-xs font-medium">{scene.title}</span>

                                                    <Button
                                                      onClick={() => {
                                                        setStatsNode({ type: 'scene', data: scene });
                                                        setStatsDialogOpen(true);
                                                      }}
                                                      variant="ghost"
                                                      size="sm"
                                                      className="h-6 w-6 p-0"
                                                    >
                                                      <Info className="size-3" />
                                                    </Button>

                                                    <DropdownMenu>
                                                      <DropdownMenuTrigger asChild>
                                                        <Button variant="ghost" size="sm" className="h-6 w-6 p-0">
                                                          <MoreVertical className="size-3" />
                                                        </Button>
                                                      </DropdownMenuTrigger>
                                                      <DropdownMenuContent align="end">
                                                        <DropdownMenuItem onClick={() => {
                                                          setEditingScene(scene.id);
                                                          setEditValues({ 
                                                            ...editValues, 
                                                            [scene.id]: { 
                                                              title: scene.title, 
                                                              description: scene.description || '',
                                                              content: scene.content || ''
                                                            } 
                                                          });
                                                          // Auto-expand when editing
                                                          const next = new Set(expandedScenes);
                                                          next.add(scene.id);
                                                          setExpandedScenes(next);
                                                        }}>
                                                          <Edit className="size-3 mr-2" />
                                                          Bearbeiten
                                                        </DropdownMenuItem>
                                                        <DropdownMenuItem onClick={() => handleDuplicateScene(scene.id)}>
                                                          <Copy className="size-3 mr-2" />
                                                          Duplizieren
                                                        </DropdownMenuItem>
                                                        <DropdownMenuItem 
                                                          onClick={() => handleDeleteScene(scene.id)}
                                                          className="text-red-600 dark:text-red-400"
                                                        >
                                                          <Trash2 className="size-3 mr-2" />
                                                          LÃ¶schen
                                                        </DropdownMenuItem>
                                                      </DropdownMenuContent>
                                                    </DropdownMenu>
                                                  </div>

                                                  {/* ðŸ“š ABSCHNITT CONTENT (Text) */}
                                                  <CollapsibleContent>
                                                    <div className="p-2">
                                                      {editingScene === scene.id ? (
                                                        <Textarea
                                                          value={editValues[scene.id]?.content ?? scene.content ?? ''}
                                                          onChange={(e) => {
                                                            const newValue = e.target.value;
                                                            setEditValues({ 
                                                              ...editValues, 
                                                              [scene.id]: { 
                                                                ...editValues[scene.id], 
                                                                content: newValue 
                                                              } 
                                                            });
                                                            
                                                            // ðŸ”¥ Debounced auto-save (WITHOUT closing the editor)
                                                            if (saveTimeoutRef.current) {
                                                              clearTimeout(saveTimeoutRef.current);
                                                            }
                                                            saveTimeoutRef.current = setTimeout(() => {
                                                              autoSaveScene(scene.id, newValue);
                                                            }, 1000); // Save 1 second after user stops typing
                                                          }}
                                                          onMouseDown={(e) => e.stopPropagation()}
                                                          onKeyDown={(e) => {
                                                            e.stopPropagation();
                                                            if (e.key === 'Escape') {
                                                              e.preventDefault();
                                                              if (saveTimeoutRef.current) {
                                                                clearTimeout(saveTimeoutRef.current);
                                                              }
                                                              handleUpdateScene(scene.id, editValues[scene.id]);
                                                            }
                                                          }}
                                                          placeholder="Schreibe den Inhalt dieses Abschnitts..."
                                                          className="min-h-[100px] text-xs font-mono"
                                                          autoFocus
                                                        />
                                                      ) : (
                                                        <div 
                                                          className="text-xs text-muted-foreground whitespace-pre-wrap font-mono cursor-pointer hover:bg-amber-100 dark:hover:bg-amber-900/20 p-2 rounded transition-colors"
                                                          onClick={() => {
                                                            setEditingScene(scene.id);
                                                            setEditValues({ 
                                                              ...editValues, 
                                                              [scene.id]: { 
                                                                title: scene.title,
                                                                content: scene.content || '' 
                                                              } 
                                                            });
                                                            // Auto-expand when editing
                                                            const next = new Set(expandedScenes);
                                                            next.add(scene.id);
                                                            setExpandedScenes(next);
                                                          }}
                                                        >
                                                          {scene.content || <em className="text-muted-foreground/50">Klicken zum Schreiben...</em>}
                                                        </div>
                                                      )}
                                                    </div>
                                                  </CollapsibleContent>
                                                </div>
                                              </Collapsible>
                                            </DraggableScene>