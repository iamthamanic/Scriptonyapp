# ğŸ¯ MODELL AUSWAHL - Kompletter Guide

## ğŸ“ Wo ist die Modell-Auswahl?

Die Modellauswahl ist **im Chat Settings Dialog** unter dem **"Modell & Prompt"** Tab!

---

## ğŸ¨ UI Flow - Schritt fÃ¼r Schritt:

### **1ï¸âƒ£ ScriptonyAssistant Ã¶ffnen**
```
Klicke auf den violetten Floating Chat Button (unten rechts)
```

### **2ï¸âƒ£ Chat Settings Ã¶ffnen**
```
Klicke auf "Chat Settings" Button
â†’ Dialog Ã¶ffnet sich mit 3 Tabs
```

### **3ï¸âƒ£ Tabs im Dialog:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Chat Settings                             [X]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  [API Keys]  [Modell & Prompt]  [RAG Database] â”‚
â”‚   ^^^^^^^^    ^^^^^^^^^^^^^^^^   ^^^^^^^^^^^^^^ â”‚
â”‚   Tab 1         Tab 2 â­          Tab 3         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## â­ Tab 2: "Modell & Prompt" - HIER IST DIE MODELLAUSWAHL!

### **Wenn du einen API Key hast:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Aktiver Provider                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚  â”‚ [OpenRouter] â”‚ â† Orange Badge                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                                                 â”‚
â”‚  Modell â­                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  openai/gpt-4o-mini               [â–¼]   â”‚  â”‚ â† DROPDOWN!
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                 â”‚
â”‚  Klick drauf â†’ Alle verfÃ¼gbaren Modelle!       â”‚
â”‚                                                 â”‚
â”‚  Temperature: 0.70                              â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚
â”‚                                                 â”‚
â”‚  Max Tokens: 2000                               â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚
â”‚                                                 â”‚
â”‚  System Prompt                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Du bist Scriptony AI...              â”‚  â”‚
â”‚  â”‚                                          â”‚  â”‚
â”‚  â”‚                                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  [Prompt speichern]                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”¥ Wie funktioniert die Modellauswahl?

### **OpenRouter - Alle Modelle verfÃ¼gbar:**
```
Klick auf Modell Dropdown:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ openai/gpt-4o                      âœ“  â”‚ â† GPT-4 Flagship
â”‚ openai/gpt-4o-mini                    â”‚ â† Schnell & gÃ¼nstig
â”‚ anthropic/claude-3.5-sonnet           â”‚ â† Claude 3.5
â”‚ anthropic/claude-3-opus               â”‚ â† Claude 3 Opus
â”‚ google/gemini-pro                     â”‚ â† Gemini
â”‚ meta-llama/llama-3.1-70b-instruct     â”‚ â† Llama 3.1
â”‚ mistralai/mistral-large              â”‚ â† Mistral
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Das SchÃ¶ne an OpenRouter:**
- âœ… Ein Key, alle Modelle!
- âœ… Einfach im Dropdown umschalten
- âœ… Keine separate Konfiguration nÃ¶tig

### **OpenAI - Nur OpenAI Modelle:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ gpt-4o                             âœ“  â”‚
â”‚ gpt-4o-mini                           â”‚
â”‚ gpt-4-turbo                           â”‚
â”‚ gpt-4                                 â”‚
â”‚ gpt-3.5-turbo                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Anthropic - Nur Claude Modelle:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ claude-3-5-sonnet-20241022         âœ“  â”‚
â”‚ claude-3-5-haiku-20241022             â”‚
â”‚ claude-3-opus-20240229                â”‚
â”‚ claude-3-sonnet-20240229              â”‚
â”‚ claude-3-haiku-20240307               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Google - Nur Gemini Modelle:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ gemini-pro                         âœ“  â”‚
â”‚ gemini-pro-vision                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Workflow: Modell wechseln

### **Szenario 1: Zwischen OpenRouter Modellen wechseln**

1. âœ… Chat Settings Ã¶ffnen
2. âœ… Tab "Modell & Prompt" wÃ¤hlen
3. âœ… Dropdown "Modell" Ã¶ffnen
4. âœ… Neues Modell auswÃ¤hlen (z.B. `anthropic/claude-3.5-sonnet`)
5. âœ… **AUTOMATISCH GESPEICHERT!** ğŸ‰
6. âœ… NÃ¤chster Chat verwendet das neue Modell

**Kein "Speichern" Button nÃ¶tig!** Das Modell wird sofort beim AuswÃ¤hlen gespeichert.

### **Szenario 2: Zwischen Providern wechseln**

Du hast mehrere API Keys (z.B. OpenRouter + OpenAI)?

1. âœ… Chat Settings Ã¶ffnen
2. âœ… Tab "API Keys" wÃ¤hlen
3. âœ… Siehe deine gespeicherten Keys:
   ```
   [OpenRouter] sk-or-***xyz1  [Aktiv]  ğŸ—‘
   [OpenAI]     sk-***abc2     [Aktivieren] ğŸ—‘
   ```
4. âœ… Klicke auf **"Aktivieren"** Button beim Provider den du verwenden willst
5. âœ… Provider wird gewechselt + Modelle neu geladen
6. âœ… Tab "Modell & Prompt" zeigt jetzt die neuen verfÃ¼gbaren Modelle
7. âœ… **FERTIG!** âœ¨

**Jetzt implementiert!** Du kannst nahtlos zwischen Providern wechseln!

---

## ğŸ”§ Backend: Wie werden Modelle geladen?

### **1. Provider Detection:**
```typescript
// User fÃ¼gt Key ein â†’ Backend erkennt Provider
POST /ai/detect-provider
Body: { api_key: "sk-or-v1-..." }

Response: {
  provider: "openrouter",
  default_model: "openai/gpt-4o-mini",
  available_models: [
    "openai/gpt-4o",
    "openai/gpt-4o-mini",
    "anthropic/claude-3.5-sonnet",
    // ...
  ]
}
```

### **2. Settings Laden:**
```typescript
// Beim Ã–ffnen der Settings
GET /ai/settings

Response: {
  settings: {
    active_provider: "openrouter",
    active_model: "openai/gpt-4o-mini",
    openrouter_api_key: "sk-or-***",
    // ...
  }
}

// Frontend macht dann:
POST /ai/detect-provider mit dem aktuellen Key
â†’ LÃ¤dt available_models
```

### **3. Modell Wechseln:**
```typescript
// User wÃ¤hlt neues Modell im Dropdown
PUT /ai/settings
Body: { active_model: "anthropic/claude-3.5-sonnet" }

Response: {
  settings: { /* updated settings */ },
  available_models: [ /* same models */ ]
}
```

---

## ğŸ¨ UI Details

### **Modell Dropdown Design:**
```typescript
<Select
  value={settings.active_model}
  onValueChange={(value) => updateSettings({ active_model: value })}
>
  <SelectTrigger>
    <SelectValue />
  </SelectTrigger>
  <SelectContent>
    {availableModels.map((model) => (
      <SelectItem key={model} value={model}>
        {model}
      </SelectItem>
    ))}
  </SelectContent>
</Select>
```

**Features:**
- âœ… Zeigt aktuell gewÃ¤hltes Modell
- âœ… Dropdown mit allen verfÃ¼gbaren Modellen
- âœ… Auto-Save beim AuswÃ¤hlen
- âœ… LÃ¤dt neue Modelle wenn Provider gewechselt wird

### **Provider Badge Design:**
```typescript
<Badge className={PROVIDER_COLORS[settings.active_provider]}>
  {PROVIDER_NAMES[settings.active_provider]}
</Badge>
```

**Colors:**
- ğŸŸ¢ OpenAI = GrÃ¼n
- ğŸŸ£ Anthropic = Lila
- ğŸ”µ Google = Blau
- ğŸŸ  OpenRouter = Orange

---

## ğŸ’¡ HÃ¤ufige Fragen

### â“ "Ich sehe keine Modelle im Dropdown?"

**Problem:** `availableModels` Array ist leer

**LÃ¶sung:**
1. Stelle sicher du hast einen API Key gespeichert
2. Gehe zu Tab "API Keys" und prÃ¼fe ob ein Key aktiv ist
3. Hard Refresh: `Cmd/Ctrl + Shift + R`
4. Console Ã¶ffnen und schauen nach Fehlern

### â“ "Warum kann ich nur OpenAI Modelle sehen wenn ich OpenRouter habe?"

**Problem:** Backend erkennt `sk-or-` nicht korrekt

**LÃ¶sung:**
1. Migration `003_add_openrouter_support.sql` ausfÃ¼hren
2. Server neu deployen
3. Hard Refresh

### â“ "Wie fÃ¼ge ich ein neues Modell hinzu?"

**Backend erweitern:**
```typescript
// /supabase/functions/server/routes-ai-chat.tsx

function getAvailableModels(provider: string): string[] {
  const models: Record<string, string[]> = {
    openrouter: [
      'openai/gpt-4o',
      'openai/gpt-4o-mini',
      'anthropic/claude-3.5-sonnet',
      'mein-neues-modell', // â† Hier hinzufÃ¼gen!
    ],
  };
  return models[provider] || [];
}
```

**Server neu deployen:**
```bash
supabase functions deploy make-server-3b52693b
```

**Hard Refresh** und neues Modell sollte sichtbar sein!

---

## ğŸš€ Quick Test

### **Test 1: Modell wechseln**
1. âœ… Chat Settings Ã¶ffnen
2. âœ… Tab "Modell & Prompt"
3. âœ… Dropdown Ã¶ffnen
4. âœ… Anderes Modell wÃ¤hlen
5. âœ… Console: sollte `PUT /ai/settings` Request sehen
6. âœ… Toast: "Einstellungen gespeichert"
7. âœ… Neue Chat Nachricht senden
8. âœ… Sollte neues Modell verwenden (in Response sichtbar)

### **Test 2: OpenRouter Multi-Model**
1. âœ… OpenRouter Key hinzufÃ¼gen
2. âœ… Tab "Modell & Prompt"
3. âœ… Dropdown sollte 7+ Modelle zeigen
4. âœ… WÃ¤hle GPT-4o â†’ Sende Chat
5. âœ… WÃ¤hle Claude 3.5 â†’ Sende Chat
6. âœ… Beide sollten funktionieren!

---

## ğŸ¯ Zusammenfassung

### **Wo ist die Modellauswahl?**
```
ScriptonyAssistant 
  â†’ Chat Settings 
    â†’ Tab "Modell & Prompt" 
      â†’ Dropdown "Modell" â­
```

### **Was passiert beim AuswÃ¤hlen?**
```
User wÃ¤hlt Modell 
  â†’ Frontend: PUT /ai/settings { active_model: "..." }
  â†’ Backend: Speichert in user_ai_settings Tabelle
  â†’ Frontend: Toast "Gespeichert" âœ…
  â†’ NÃ¤chster Chat: Verwendet neues Modell
```

### **OpenRouter = Best of All Worlds:**
```
Ein Key = 7+ Modelle
  â†’ GPT-4o (OpenAI)
  â†’ Claude 3.5 (Anthropic)
  â†’ Gemini Pro (Google)
  â†’ Llama 3.1 (Meta)
  â†’ Mistral Large (Mistral)
  
Einfach im Dropdown wechseln! ğŸ‰
```

---

## âœ… Was du jetzt wissen musst:

1. **Modellauswahl ist FERTIG** - sie ist im Dialog unter "Modell & Prompt"
2. **Auto-Save** - Modell wird sofort gespeichert beim AuswÃ¤hlen
3. **OpenRouter** - Zugriff auf alle Top-Modelle mit einem Key
4. **Direkte Provider** - Nur die Modelle des jeweiligen Providers
5. **Dropdown UI** - Zeigt alle verfÃ¼gbaren Modelle fÃ¼r deinen Provider

**Du musst nichts extra machen - es funktioniert bereits!** ğŸ‰

---

## ğŸ”œ NÃ¤chste Verbesserung (Optional):

**Provider Switcher UI:**
- Aktuell: Letzter hinzugefÃ¼gter Key ist aktiv
- Besser: Button zum Wechseln zwischen gespeicherten Keys
- UI Idee: Klickbare Badges in Tab "API Keys"

**Soll ich das implementieren?** ğŸ¤”
